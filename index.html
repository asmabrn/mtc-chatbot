<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maghreb Truck Company SPA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            height: 100vh;
            background: linear-gradient(135deg, #0c0c0c 0%, #222222 50%, #333333 100%);
            position: relative;
        }

        /* Effet de particules avec plus de luminosit√© */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.25) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(150, 150, 150, 0.15) 0%, transparent 50%);
            z-index: 1;
            animation: particleMove 20s linear infinite;
        }

        @keyframes particleMove {
            0% {
                transform: translate(0, 0);
            }

            100% {
                transform: translate(50px, 50px);
            }
        }

        /* Background avec plus de luminosit√© */
        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(135deg,
                    rgba(40, 40, 40, 0.9) 0%,
                    rgba(70, 70, 70, 0.85) 50%,
                    rgba(30, 30, 30, 0.9) 100%),
                url('./background\ \(2\).png');
            background-size: cover, cover;
            background-position: center, center;
            background-repeat: no-repeat;
            background-blend-mode: overlay, normal;
            z-index: 1;
            filter: grayscale(0.2) contrast(1.2) brightness(1.1);
            animation: textureShift 30s linear infinite;
        }

        @keyframes textureShift {
            0% {
                background-position: center, center;
            }

            100% {
                background-position: center, calc(100% + 100px) calc(100% + 100px);
            }
        }

        /* Overlay plus lumineux */
        .background::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg,
                    rgba(0, 0, 0, 0.5) 0%,
                    rgba(50, 50, 50, 0.5) 50%,
                    rgba(0, 0, 0, 0.5) 100%);
            z-index: 2;
        }

        /* Effet de grille avec plus de luminosit√© */
        .background::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255, 255, 255, 0.04) 2px, rgba(255, 255, 255, 0.04) 4px),
                repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(255, 255, 255, 0.02) 2px, rgba(255, 255, 255, 0.02) 4px);
            z-index: 3;
            opacity: 0.6;
        }

        /* Header r√©duit avec effet n√©on plus lumineux */
        .header {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            text-align: center;
            z-index: 10;
            padding: 15px;
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(255, 255, 255, 0.1) 20%,
                    rgba(255, 255, 255, 0.15) 50%,
                    rgba(255, 255, 255, 0.1) 80%,
                    transparent 100%);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
            animation: headerSlide 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes headerSlide {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Titre plus petit et plus lumineux */
        .header h1 {
            color: transparent;
            font-size: 2.5rem;
            font-weight: 900;
            text-shadow: none;
            letter-spacing: 2px;
            background: linear-gradient(90deg,
                    #ffffff 0%,
                    #dddddd 25%,
                    #aaaaaa 50%,
                    #dddddd 75%,
                    #ffffff 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            animation: shine 3s linear infinite;
            position: relative;
        }

        .header h1::after {
            content: 'MAGHREB TRUCK COMPANY SPA';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(255, 255, 255, 0.4) 50%,
                    transparent 100%);
            -webkit-background-clip: text;
            background-clip: text;
            animation: shineOverlay 3s linear infinite;
            opacity: 0.6;
        }

        @keyframes shine {
            to {
                background-position: 200% center;
            }
        }

        @keyframes shineOverlay {
            to {
                background-position: -200% center;
            }
        }

        /* Container principal */
        .main-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 120px 60px 60px;
            z-index: 5;
            gap: 30px;
        }

        /* Section Avatar 3D - Ajust√© pour √©quilibrer avec la bulle r√©duite */
        .avatar-container {
            width: 65%;
            height: 85vh;
            position: relative;
            z-index: 6;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 2%;
            perspective: 1000px;
        }

        .avatar-container::before {
            content: '';
            position: absolute;
            width: 80%;
            height: 80%;
            background: radial-gradient(circle at center,
                    rgba(59, 130, 246, 0.25) 0%,
                    transparent 70%);
            border-radius: 50%;
            filter: blur(50px);
            animation: pulse 4s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
                opacity: 0.6;
            }

            50% {
                transform: scale(1.1);
                opacity: 0.9;
            }
        }

        #canvas {
            width: 100% !important;
            height: 100% !important;
            display: block;
            filter:
                drop-shadow(0 20px 40px rgba(0, 0, 0, 0.8)) drop-shadow(0 0 40px rgba(59, 130, 246, 0.4));
            transform-style: preserve-3d;
            /* Animation float supprim√©e */
        }

        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg,
                    rgba(40, 40, 40, 0.95) 0%,
                    rgba(60, 60, 60, 0.95) 100%);
            color: white;
            padding: 25px 50px;
            border-radius: 20px;
            font-size: 1.2rem;
            text-align: center;
            z-index: 100;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow:
                0 20px 40px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: loadingPulse 2s ease-in-out infinite;
        }

        @keyframes loadingPulse {

            0%,
            100% {
                box-shadow:
                    0 20px 40px rgba(0, 0, 0, 0.5),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2),
                    0 0 30px rgba(59, 130, 246, 0.4);
            }

            50% {
                box-shadow:
                    0 20px 40px rgba(0, 0, 0, 0.5),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2),
                    0 0 50px rgba(59, 130, 246, 0.7);
            }
        }

        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.15);
            border-top: 3px solid #ffffff;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            animation: spin 1s linear infinite;
            margin: 15px auto;
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.3);
        }

        /* Bulle de chat - CORRIG√âE avec meilleure disposition */
        .chat-bubble {
            width: 40%;
            height: 70vh;
            min-height: 400px;
            max-height: 70vh;
            background: linear-gradient(135deg,
                    rgba(119, 116, 116, 0.45) 0%,
                    rgba(70, 70, 70, 0.65) 50%,
                    rgba(50, 50, 50, 0.45) 100%);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            border-radius: 20px;
            padding: 20px;
            box-shadow:
                0 20px 40px -12px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(224, 221, 221, 0.25),
                inset 0 -1px 0 rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.267);
            position: relative;
            z-index: 7;
            border: 1px solid rgba(255, 255, 255, 0.418);
            display: flex;
            flex-direction: column;
            margin-right: 2%;
            overflow: hidden;
            animation: chatAppear 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes chatAppear {
            from {
                opacity: 0;
                transform: translateX(100px) scale(0.9);
            }

            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        /* Bordure lumineuse anim√©e - plus lumineuse */
        .chat-bubble::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 20px;
            padding: 2px;
            background: linear-gradient(135deg,
                    rgba(255, 255, 255, 0.4),
                    rgba(150, 150, 150, 0.2),
                    rgba(255, 255, 255, 0.4));
            -webkit-mask:
                linear-gradient(#fff 0 0) content-box,
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            animation: borderRotate 10s linear infinite;
        }

        @keyframes borderRotate {
            from {
                background-position: 0% 0%;
            }

            to {
                background-position: 200% 200%;
            }
        }

        /* Fl√®che avec effet de tra√Æn√©e - plus lumineuse */
        .chat-bubble::after {
            content: '';
            position: absolute;
            left: -18px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
            border-right: 18px solid rgba(255, 255, 255, 0.25);
            filter: drop-shadow(0 0 12px rgba(59, 130, 246, 0.6));
            animation: arrowFlow 3s ease-in-out infinite;
        }

        @keyframes arrowFlow {

            0%,
            100% {
                filter: drop-shadow(0 0 12px rgba(59, 130, 246, 0.6));
                opacity: 1;
            }

            50% {
                filter: drop-shadow(0 0 25px rgba(59, 130, 246, 0.9));
                opacity: 0.8;
            }
        }

        .chat-bubble h2 {
            color: #f0f0f0;
            font-size: 1.2rem;
            line-height: 1.5;
            margin-bottom: 15px;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            background: linear-gradient(90deg, #ffffff, #dddddd);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            flex-shrink: 0;
        }

        /* Boutons d'action - SUR LA M√äME LIGNE */
        .action-buttons {
            display: flex;
            flex-direction: row;
            gap: 10px;
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        .action-btn {
            flex: 1;
            padding: 12px 15px;
            background: linear-gradient(135deg,
                    rgba(131, 127, 127, 0.85) 0%,
                    rgba(60, 60, 60, 0.85) 100%);
            color: #ffffff;
            border: none;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow:
                0 4px 12px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
            white-space: nowrap;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 255, 255, 0.15),
                    transparent);
            transition: left 0.5s ease;
        }

        .action-btn:hover {
            transform: translateY(-3px) scale(1.02);
            background: linear-gradient(135deg,
                    rgba(50, 50, 50, 0.95) 0%,
                    rgba(70, 70, 70, 0.95) 100%);
            box-shadow:
                0 6px 20px rgba(0, 0, 0, 0.4),
                0 0 25px rgba(59, 130, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.25);
        }

        .action-btn:hover::before {
            left: 100%;
        }

        /* Zone de messages - CORRECTIONS CRITIQUES */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 15px;
            padding: 15px;
            background: linear-gradient(135deg,
                    rgba(40, 40, 40, 0.45) 0%,
                    rgba(50, 50, 50, 0.65) 100%);
            backdrop-filter: blur(15px);
            border-radius: 12px;
            display: none;
            border: 1px solid rgba(255, 255, 255, 0.15);
            min-height: 200px;
            max-height: calc(70vh - 200px);
            overflow-x: hidden;
            /* Emp√™che le d√©filement horizontal */
            width: 100%;
            box-sizing: border-box;
        }

        .messages-container.active {
            display: flex;
            flex-direction: column;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .messages-container::-webkit-scrollbar {
            width: 5px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #5a6575, #3a4555);
            border-radius: 10px;
        }

        /* STYLE DES MESSAGES CORRIG√âS - SOLUTION D√âFINITIVE */
        .message {
            margin-bottom: 10px;
            padding: 12px 16px;
            border-radius: 12px;
            animation: slideIn 0.4s ease;
            font-size: 0.9rem;
            position: relative;
            overflow: visible;
            /* Chang√© de hidden √† visible */
            width: auto;
            max-width: 100%;
            /* Garantit que le message ne d√©passe pas */
            box-sizing: border-box;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            /* IMPORTANT: permet le retour √† la ligne */
            word-break: break-word;
        }

        /* Style sp√©cifique pour les messages d'assistant (r√©ponses) */
        .message.assistant {
            background: linear-gradient(135deg,
                    rgba(55, 55, 55, 0.95) 0%,
                    rgba(70, 70, 70, 0.95) 100%);
            color: #f0f0f0;
            align-self: flex-start;
            margin-right: auto;
            margin-left: 0;
            backdrop-filter: blur(10px);
            box-shadow:
                0 4px 12px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
            max-width: 90%;
            /* R√©duit pour √©viter les d√©bordements */
        }

        /* Style pour les messages utilisateur */
        .message.user {
            background: linear-gradient(135deg,
                    rgba(30, 64, 175, 0.95) 0%,
                    rgba(37, 99, 235, 0.95) 100%);
            color: white;
            align-self: flex-end;
            margin-left: auto;
            margin-right: 0;
            backdrop-filter: blur(10px);
            box-shadow:
                0 4px 12px rgba(30, 64, 175, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.25);
            max-width: 90%;
        }

        /* Style pour le contenu HTML dans les messages */
        .message.assistant p,
        .message.assistant div,
        .message.assistant strong,
        .message.assistant a {
            max-width: 100%;
            overflow-wrap: break-word;
            word-break: break-word;
            white-space: normal;
            /* ESSENTIEL: permet aux √©l√©ments HTML de faire des retours √† la ligne */
        }

        /* Style sp√©cifique pour les liens */
        .message.assistant a {
            color: #7ea1da;
            text-decoration: none;
            display: inline-block;
            max-width: 100%;
            word-break: break-all;
            /* Permet de casser les URLs longs */
        }

        .message.assistant a:hover {
            text-decoration: underline;
        }

        /* Conteneur interne pour le contenu des messages assistant */
        .message-content {
            width: 100%;
            max-width: 100%;
            overflow-wrap: break-word;
            word-break: break-word;
            white-space: normal;
        }

        /* Pour les div √† l'int√©rieur des messages */
        .message.assistant div {
            max-width: 100% !important;
            width: 100% !important;
            overflow: visible !important;
            white-space: normal !important;
        }

        .message::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 255, 255, 0.25),
                    transparent);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(15px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .message.typing {
            background: linear-gradient(135deg,
                    rgba(70, 70, 70, 0.85) 0%,
                    rgba(90, 90, 90, 0.85) 100%);
            color: #a0aec0;
            font-style: italic;
            position: relative;
            align-self: flex-start;
        }

        .message.typing::after {
            content: '...';
            position: absolute;
            animation: typing 1.5s infinite;
        }

        @keyframes typing {

            0%,
            100% {
                content: '.';
            }

            33% {
                content: '..';
            }

            66% {
                content: '...';
            }
        }

        /* Input de chat */
        .chat-input-container {
            display: flex;
            gap: 10px;
            background: linear-gradient(135deg,
                    rgba(50, 50, 50, 0.85) 0%,
                    rgba(60, 60, 60, 0.85) 100%);
            backdrop-filter: blur(15px);
            border-radius: 12px;
            padding: 8px;
            box-shadow:
                0 6px 25px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.15);
            position: relative;
            overflow: hidden;
            min-height: 60px;
            align-items: center;
            flex-shrink: 0;
            margin-top: auto;
        }

        .chat-input-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 255, 255, 0.08),
                    transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% {
                left: -100%;
            }

            100% {
                left: 100%;
            }
        }

        #userInput {
            flex: 1;
            min-width: 0;
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            font-size: 0.95rem;
            outline: none;
            color: #ffffff;
            background: rgba(40, 40, 40, 0.7);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            min-height: 44px;
            display: flex;
            align-items: center;
        }

        #userInput:focus {
            background: rgba(50, 50, 50, 0.85);
            box-shadow:
                0 0 0 2px rgba(59, 130, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        #userInput::placeholder {
            color: #a0aec0;
        }

        /* Bouton Send */
        #sendBtn {
            padding: 12px 25px;
            background: linear-gradient(135deg,
                    #1e40af 0%,
                    #1e3a8a 50%,
                    #1e40af 100%);
            background-size: 200% 100%;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow:
                0 4px 15px rgba(30, 64, 175, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.25);
            flex-shrink: 0;
            min-width: 80px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #sendBtn:hover {
            background-position: 100% 0;
            transform: translateY(-1px);
            box-shadow:
                0 6px 25px rgba(30, 64, 175, 0.7),
                0 0 25px rgba(30, 64, 175, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.35);
        }

        #sendBtn:active {
            transform: translateY(0);
        }

        #sendBtn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            background: linear-gradient(135deg,
                    #5a6575 0%,
                    #3a4555 100%);
        }

        /* Effets de lumi√®re avec plus de luminosit√© */
        .light-effect {
            position: fixed;
            width: 350px;
            height: 350px;
            border-radius: 50%;
            background: radial-gradient(circle,
                    rgba(59, 130, 246, 0.15) 0%,
                    transparent 70%);
            filter: blur(70px);
            z-index: 2;
            animation: lightMove 20s linear infinite;
        }

        .light-effect:nth-child(1) {
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }

        .light-effect:nth-child(2) {
            top: 60%;
            right: 10%;
            animation-delay: -10s;
        }

        @keyframes lightMove {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            25% {
                transform: translate(100px, -50px) scale(1.1);
            }

            50% {
                transform: translate(-50px, 100px) scale(0.9);
            }

            75% {
                transform: translate(-100px, -50px) scale(1.1);
            }
        }

        /* Responsive - ajustements pour la nouvelle taille */
        @media (max-width: 1400px) {
            .header h1 {
                font-size: 2.2rem;
            }

            .chat-bubble {
                padding: 20px;
                width: 35%;
            }

            .avatar-container {
                width: 60%;
            }
        }

        @media (max-width: 1200px) {
            .main-container {
                padding: 120px 40px 40px;
            }

            .avatar-container {
                width: 55%;
            }

            .chat-bubble {
                width: 40%;
            }
        }

        @media (max-width: 1024px) {
            .main-container {
                flex-direction: column;
                justify-content: flex-start;
                gap: 30px;
                padding-top: 120px;
                height: auto;
                min-height: 100vh;
            }

            .avatar-container {
                width: 80%;
                height: 450px;
                margin-bottom: 20px;
                margin-left: 0;
            }

            .chat-bubble {
                width: 85%;
                min-height: 500px;
                margin-bottom: 30px;
                margin-right: 0;
                max-height: 500px;
                height: auto;
            }

            .chat-bubble::after {
                display: none;
            }

            .header h1 {
                font-size: 2rem;
            }

            .messages-container {
                max-height: 350px;
            }

            .action-buttons {
                flex-direction: row;
            }

            .action-btn {
                padding: 10px 12px;
                font-size: 0.85rem;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 120px 25px 25px;
            }

            .chat-bubble {
                width: 95%;
                padding: 15px;
                min-height: 450px;
                max-height: 450px;
            }

            .avatar-container {
                width: 95%;
                height: 350px;
            }

            .header h1 {
                font-size: 1.8rem;
                letter-spacing: 1px;
            }

            .chat-bubble h2 {
                font-size: 1.1rem;
            }

            #sendBtn {
                min-width: 70px;
                padding: 10px 20px;
            }

            .messages-container {
                max-height: 300px;
            }

            .action-buttons {
                flex-direction: row;
                gap: 8px;
            }

            .action-btn {
                padding: 10px 12px;
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.4rem;
            }

            .chat-bubble {
                padding: 12px;
                min-height: 400px;
                max-height: 400px;
            }

            .action-btn {
                padding: 8px 10px;
                font-size: 0.75rem;
            }

            #userInput {
                padding: 10px 14px;
            }

            #sendBtn {
                min-width: 65px;
                padding: 10px 15px;
                font-size: 0.9rem;
            }

            .messages-container {
                max-height: 250px;
            }

            .action-buttons {
                flex-direction: column;
                gap: 8px;
            }
        }
    </style>
</head>

<body>
    <!-- Effets de lumi√®re avec plus de luminosit√© -->
    <div class="light-effect"></div>
    <div class="light-effect"></div>

    <!-- Background avec image du camion -->
    <div class="background"></div>

    <!-- Header -->
    <div class="header">
        <h1>MAGHREB TRUCK COMPANY SPA</h1>
    </div>

    <!-- Container principal -->
    <div class="main-container">
        <!-- Avatar 3D -->
        <div class="avatar-container">
            <div id="loading">
                <div class="spinner"></div>
                Chargement de l'avatar...
            </div>
            <canvas id="canvas"></canvas>
        </div>

        <!-- Bulle de chat am√©lior√©e -->
        <div class="chat-bubble" id="chatBubble">
            <h2>Hello! I'm AiMan, MTC Assistant. I'm available 24/7 to answer your questions about our company.</h2>

            <!-- Les boutons sont maintenant SUR LA M√äME LIGNE -->
            <div class="action-buttons" id="actionButtons">
                <button class="action-btn" onclick="quickQuestion('Present MTC SPA to me! ')">
                    Present MTC SPA to me!
                </button>

                <button class="action-btn" onclick="quickQuestion('Contacts ! ')">
                    Contacts !
                </button>
            </div>

            <div class="messages-container" id="messagesContainer"></div>

            <div class="chat-input-container">
                <input type="text" id="userInput" placeholder="Ask your question here..."
                    onkeypress="handleKeyPress(event)">
                <button id="sendBtn" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r128/examples/js/loaders/GLTFLoader.js"></script>

    <script>
        let model = null;
        let isTyping = false;
        let baseYPosition = 0;

        // Base de connaissances MTC SPA
        const mtcKnowledgeBase = {
            "contact": {
                keywords: ["contact", "contacts", "phone", "email", "coordinate", "coordonn√©es", "t√©l√©phone", "mail"],
                r√©ponse: `<div class="message-content">
                <p><strong>üìû MTC Algiers Contacts:</strong></p>
                
                <div style="margin: 8px 0;">
                    <strong>Commercial Service</strong><br>
                    <a href="tel:023-450290 / 023-450965 / 023-450966">023-450290 / 023-450965 / 023-450966</a><br>
                    <a href="mailto:service.commercial@mtc-man.com">service.commercial@mtc-man.com</a>
                </div>
                
                <div style="margin: 8px 0;">
                    <strong>After-Sales Service</strong><br>
                    <a href="tel:023-450970">023-450970</a><br>
                    <a href="mailto:sav@mtc-man.com">sav@mtc-man.com</a>
                </div>
                
                <div style="margin: 8px 0;">
                    <strong>Spare Parts</strong><br>
                    <a href="tel:023-450957 / 023-450968 / 023-450982">023-450957 / 023-450968 / 023-450982</a><br>
                    <a href="mailto:pdr@mtc-man.com">pdr@mtc-man.com</a>
                </div>
                
                <div style="margin: 8px 0;">
                    <strong>Marketing Service</strong><br>
                    <a href="tel:023-450957 / 023-450968 / 023-450982">023-450957 / 023-450968 / 023-450982</a><br>
                    <a href="mailto:mehdi.laroui@mtc-man.com">mehdi.laroui@mtc-man.com</a>
                </div>
                
                <p><strong>üåê Website:</strong> <a href="https://mtc-man.com" target="_blank">https://mtc-man.com</a></p>
            </div>`
            },
            "presentation": {
                keywords: ["present", "presentation", "introduce", "about", "pr√©senter", "pr√©sentation", "√† propos"],
                r√©ponse: `<div class="message-content">
                <p><strong>MTC (Maghreb Truck Company)</strong> is the exclusive dealer of MAN Truck & Bus in Algeria.</p>
                <p>With <strong>over 23 years of experience</strong>, MTC offers complete solutions for goods and passenger transport with an extensive range of MAN industrial vehicles.</p>
            </div>`
            },
            "need_truck": {
                keywords: ["need a truck", "want a truck", "looking for a truck", "buy a truck", "acheter un camion", "besoin d'un camion"],
                r√©ponse: `<div class="message-content">
                <p><strong>Of course. Could you please tell me the application of the truck?</strong></p>
                <p>Is it for construction, logistics, long-haul transport, tanker, or any specific mission?</p>
            </div>`
            },
            "mineral_water": {
                keywords: ["mineral water", "water transport", "transporting mineral water", "eau min√©rale", "transport d'eau", "bottled water"],
                r√©ponse: `<div class="message-content">
                <p><strong>Thank you. For mineral water transport, you need a fuel-efficient and reliable 4x2 tractor optimized for long-distance distribution.</strong></p>
                <p>Based on your mission, I recommend the:</p>
                <p><strong>MAN TGS 18.440 BLS (4x2)</strong></p>
                <p>A robust, efficient tractor with excellent fuel economy and a very competitive TCO.</p>
            </div>`
            },
            "datasheet": {
                keywords: ["technical datasheet", "datasheet", "technical sheet", "fiche technique", "sp√©cifications", "specs", "can i get the technical datasheet"],
                r√©ponse: `<div class="message-content">
                <p><strong>Absolutely.</strong></p>
                <p>You can access the full technical sheet via the following link:</p>
                <p><a href="http://www.man-mtc.com/FT" target="_blank" style="color: #3b82f6; text-decoration: none; font-weight: bold;">www.man-mtc.com/FT</a></p>
                <p>Or contact our commercial department directly at: <strong>023 45 09 66</strong></p>
                <p>One of our advisors will be happy to assist you and send you the full documentation.</p>
                <p>Would you like me to prepare a quotation or check the estimated delivery time?</p>
            </div>`
            },
            "after_sales": {
                keywords: ["after-sales", "after sales", "support", "need after-sales support", "after-sales support", "sav", "service apr√®s-vente"],
                r√©ponse: `<div class="message-content">
                <p><strong>Of course. Could you tell me the type of issue you're facing with your vehicle?</strong></p>
            </div>`
            },
            "mechanical_issue": {
                keywords: ["mechanical issue", "mechanical problem", "need a repair", "repair", "probl√®me m√©canique", "panne", "d√©faillance"],
                r√©ponse: `<div class="message-content">
                <p><strong>I can help you with that.</strong></p>
                <p>To assist you properly, I need a few details:</p>
                <ul>
                    <li>The vehicle chassis number (VIN)</li>
                    <li>The model</li>
                    <li>A brief description of the problem</li>
                    <li>And whether the truck is immobilized or still drivable.</li>
                </ul>
            </div>`
            },
            "immobilized": {
                keywords: ["immobilized", "immobilised", "not drivable", "broken down", "won't move", "immobilis√©", "ne bouge plus", "en panne"],
                r√©ponse: `<div class="message-content">
                <p><strong>Understood.</strong></p>
                <p>For immobilized vehicles, our After-Sales team will give you priority assistance.</p>
                <p>You can reach our SAV directly at:</p>
                <p><strong>023 45 09 80</strong></p>
                <p>Or visit our workshop at MTC Birkhadem, open from 8:00 to 17:00.</p>
            </div>`
            },
            "price_truck": {
                keywords: ["price", "cost", "how much", "prix", "co√ªt", "combien"],
                r√©ponse: `<div class="message-content">
                <p><strong>Prices vary by configuration. I can help you choose the right model and provide an indicative offer before our sales team contacts you.</strong></p>
            </div>`
            },
            "model_available": {
                keywords: ["model available", "in stock", "available", "disponible", "en stock"],
                r√©ponse: `<div class="message-content">
                <p><strong>I can check the current availability and show you the closest equivalent models if stock is limited.</strong></p>
            </div>`
            },
            "delivery": {
                keywords: ["delivery time", "delivery", "lead time", "d√©lai", "livraison"],
                r√©ponse: `<div class="message-content">
                <p><strong>Delivery time depends on configuration and production schedule. On average, it ranges from 6 to 14 weeks.</strong></p>
            </div>`
            },
            "right_trucks": {
                keywords: ["right truck", "choose truck", "which truck", "quel camion", "choisir"],
                r√©ponse: `<div class="message-content">
                <p><strong>Absolutely. Tell me your load, route type, and annual mileage, and I will recommend the best MAN configuration.</strong></p>
            </div>`
            },
            "warning": {
                keywords: ["warning light", "warning", "light on", "voyant", "alerte"],
                r√©ponse: `<div class="message-content">
                <p><strong>I can help identify the meaning of the warning light and guide you step-by-step. If needed, I'll help you book a workshop appointment.</strong></p>
            </div>`
            },
            "workshop": {
                keywords: ["nearest workshop", "workshop", "service center", "atelier", "centre service"],
                r√©ponse: `<div class="message-content">
                <p><strong>I can locate the closest MAN/MTC service point and provide directions, contact, and opening hours.</strong></p>
            </div>`
            },
            "maintenance": {
                keywords: ["preventive maintenance", "maintenance cost", "maintenance", "entretien", "maintenance pr√©ventive"],
                r√©ponse: `<div class="message-content">
                <p><strong>I can estimate maintenance costs based on your model, mileage, and operation type.</strong></p>
            </div>`
            },
            "spare_part": {
                keywords: ["spare part", "part", "component", "pi√®ce", "rechange", "composant"],
                r√©ponse: `<div class="message-content">
                <p><strong>Tell me the part number or describe the component, and I will check availability and alternatives.</strong></p>
            </div>`
            },
            "track_fleet": {
                keywords: ["track", "fleet", "tracking", "suivre", "flotte", "localisation"],
                r√©ponse: `<div class="message-content">
                <p><strong>Yes. I provide access to fleet data, tracking status, and performance insights depending on your connected services.</strong></p>
            </div>`
            },
            "warranty": {
                keywords: ["warranty", "guarantee", "garantie"],
                r√©ponse: `<div class="message-content">
                <p><strong>Standard warranty is 1 year, extendable depending on model and usage. I can provide details for your exact vehicle.</strong></p>
            </div>`
            },
            "financing": {
                keywords: ["financing", "finance", "loan", "credit", "financement", "cr√©dit"],
                r√©ponse: `<div class="message-content">
                <p><strong>Yes. I can provide financing simulations and guide you toward the best plan based on your business.</strong></p>
            </div>`
            },
            "training": {
                keywords: ["driver training", "training", "formation", "conducteur"],
                r√©ponse: `<div class="message-content">
                <p><strong>Yes. MTC offers MAN-approved driver training programs. I can schedule a session for your drivers.</strong></p>
            </div>`
            },
            "hello": {
                keywords: ["hello", "hi", "hey", "good morning", "good afternoon", "bonjour", "salut"],
                r√©ponse: `<div class="message-content">
                <p><strong>Hello! How can I assist you today?</strong></p>
            </div>`
            },
            "thank_you": {
                keywords: ["thank", "thanks", "merci", "thank you"],
                r√©ponse: `<div class="message-content">
                <p><strong>You're welcome! Don't hesitate if you have other questions about MTC and our MAN services. üòä</strong></p>
            </div>`
            }
        };

        // Fonction intelligente pour trouver la r√©ponse
        function getResponse(message) {
            const lowerMessage = message.toLowerCase().trim();

            // D'abord v√©rifier les salutations courtes
            if (lowerMessage === "hello aiman" || lowerMessage === "hello" || lowerMessage === "hi" || lowerMessage === "hey" || lowerMessage === "bonjour") {
                return mtcKnowledgeBase.hello.r√©ponse;
            }

            // V√©rifier les remerciements
            if (lowerMessage.includes("thank") || lowerMessage.includes("thanks") || lowerMessage.includes("merci")) {
                return mtcKnowledgeBase.thank_you.r√©ponse;
            }

            // Liste des cat√©gories avec leur priorit√© (les plus sp√©cifiques d'abord)
            const categories = [
                { key: "need_truck", priority: 1 },
                { key: "mineral_water", priority: 2 },
                { key: "datasheet", priority: 3 },
                { key: "after_sales", priority: 4 },
                { key: "mechanical_issue", priority: 5 },
                { key: "immobilized", priority: 6 },
                { key: "contact", priority: 7 },
                { key: "presentation", priority: 8 },
                { key: "price_truck", priority: 9 },
                { key: "model_available", priority: 10 },
                { key: "delivery", priority: 11 },
                { key: "right_trucks", priority: 12 },
                { key: "warning", priority: 13 },
                { key: "workshop", priority: 14 },
                { key: "maintenance", priority: 15 },
                { key: "spare_part", priority: 16 },
                { key: "track_fleet", priority: 17 },
                { key: "warranty", priority: 18 },
                { key: "financing", priority: 19 },
                { key: "training", priority: 20 }
            ];

            // Trier par priorit√©
            categories.sort((a, b) => a.priority - b.priority);

            // Chercher une correspondance
            for (const category of categories) {
                const data = mtcKnowledgeBase[category.key];
                if (data && data.keywords) {
                    for (const keyword of data.keywords) {
                        if (lowerMessage.includes(keyword)) {
                            return data.r√©ponse;
                        }
                    }
                }
            }

            // Si aucun mot-cl√© n'est trouv√©, r√©ponse par d√©faut
            return `<div class="message-content">
            <p><strong>I'm sorry, I didn't quite understand your question.</strong></p>
            <p>I'm AiMan, MTC's expert in MAN solutions. My areas of expertise are:</p>
            <ul>
                <li>Truck sales and recommendations</li>
                <li>Technical specifications</li>
                <li>After-sales service and repairs</li>
                <li>Spare parts availability</li>
                <li>Maintenance and workshop locations</li>
                <li>Financing options</li>
                <li>Driver training programs</li>
            </ul>
            <p>Which aspect can I help you with today?</p>
        </div>`;
        }

        // Initialisation de la sc√®ne 3D - SANS ANIMATION
        window.addEventListener('load', function () {
            const scene = new THREE.Scene();
            scene.background = null;

            const canvas = document.getElementById('canvas');
            const container = document.querySelector('.avatar-container');

            const camera = new THREE.PerspectiveCamera(
                45,
                container.offsetWidth / container.offsetHeight,
                0.1,
                1000
            );

            camera.position.set(0, 1.0, 3.5);
            camera.lookAt(0, 0.8, 0);

            const renderer = new THREE.WebGLRenderer({
                canvas: canvas,
                antialias: true,
                alpha: true
            });

            renderer.setSize(container.offsetWidth, container.offsetHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

            // √âclairage
            const ambientLight = new THREE.AmbientLight(0xffffff, 1.8);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 2.0);
            directionalLight.position.set(5, 10, 7);
            scene.add(directionalLight);

            const fillLight = new THREE.DirectionalLight(0x3b82f6, 1.2);
            fillLight.position.set(-5, 5, -5);
            scene.add(fillLight);

            const rimLight = new THREE.DirectionalLight(0xffffff, 1.0);
            rimLight.position.set(0, 5, -5);
            scene.add(rimLight);

            // Charger l'avatar
            const loader = new THREE.GLTFLoader();
            const avatarUrl = 'https://raw.githubusercontent.com/asmabrn/avatar-3/main/test.glb';

            loader.load(
                avatarUrl,
                function (gltf) {
                    console.log("‚úÖ Avatar charg√© avec succ√®s!");
                    document.getElementById('loading').style.display = 'none';

                    model = gltf.scene;

                    const box = new THREE.Box3().setFromObject(model);
                    const size = box.getSize(new THREE.Vector3());
                    const center = box.getCenter(new THREE.Vector3());

                    model.position.x = -center.x;
                    model.position.y = -center.y - 0.9;
                    model.position.z = -center.z;

                    baseYPosition = model.position.y;

                    const maxDim = Math.max(size.x, size.y, size.z);
                    const scale = 3.8 / maxDim;
                    model.scale.set(scale, scale, scale);

                    scene.add(model);

                    let mixer = null;
                    const clock = new THREE.Clock();

                    if (gltf.animations && gltf.animations.length > 0) {
                        mixer = new THREE.AnimationMixer(model);
                        gltf.animations.forEach((clip) => {
                            mixer.clipAction(clip).play();
                        });
                    }

                    function animate() {
                        requestAnimationFrame(animate);
                        const delta = clock.getDelta();

                        if (mixer) {
                            mixer.update(delta);
                        }
                        // Supprim√© toutes les animations de rotation et de position

                        renderer.render(scene, camera);
                    }
                    animate();

                    window.addEventListener('resize', function () {
                        const newWidth = container.offsetWidth;
                        const newHeight = container.offsetHeight;

                        camera.aspect = newWidth / newHeight;
                        camera.updateProjectionMatrix();
                        renderer.setSize(newWidth, newHeight);
                    });
                },
                function (progress) {
                    const percent = (progress.loaded / progress.total * 100) || 0;
                    document.getElementById('loading').innerHTML =
                        `<div class="spinner"></div>Chargement: ${Math.round(percent)}%`;
                },
                function (error) {
                    console.error('‚ùå Erreur de chargement:', error);
                    document.getElementById('loading').innerHTML =
                        '<span style="color: #ff6b6b;">‚ùå Erreur de chargement</span><br><small>V√©rifiez la console</small>';

                    createFallbackAvatar(scene, renderer, camera, container);
                }
            );
        });

        // Fonction pour cr√©er un avatar de secours - SANS ANIMATION
        function createFallbackAvatar(scene, renderer, camera, container) {
            const bodyGeometry = new THREE.CapsuleGeometry(0.7, 1.4, 4, 8);
            const bodyMaterial = new THREE.MeshPhongMaterial({
                color: 0x3498db,
                shininess: 30
            });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.position.y = 0.4;
            scene.add(body);

            const headGeometry = new THREE.SphereGeometry(0.4, 16, 16);
            const headMaterial = new THREE.MeshPhongMaterial({
                color: 0xf1c27d
            });
            const head = new THREE.Mesh(headGeometry, headMaterial);
            head.position.y = 1.3;
            scene.add(head);

            const eyeGeometry = new THREE.SphereGeometry(0.07, 8, 8);
            const eyeMaterial = new THREE.MeshPhongMaterial({ color: 0x000000 });

            const leftEye = new THREE.Mesh(eyeGeometry, eyeMaterial);
            leftEye.position.set(-0.12, 1.35, 0.3);
            scene.add(leftEye);

            const rightEye = new THREE.Mesh(eyeGeometry, eyeMaterial);
            rightEye.position.set(0.12, 1.35, 0.3);
            scene.add(rightEye);

            model = new THREE.Group();
            model.add(body, head, leftEye, rightEye);

            baseYPosition = model.position.y;

            function animate() {
                requestAnimationFrame(animate);
                // Supprim√© la rotation automatique
                renderer.render(scene, camera);
            }
            animate();

            console.log("‚úÖ Avatar de secours cr√©√©");
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();

            if (!message) return;

            const messagesContainer = document.getElementById('messagesContainer');

            messagesContainer.classList.add('active');

            addMessage(message, 'user');
            input.value = '';

            document.getElementById('sendBtn').disabled = true;
            isTyping = true;

            addMessage('Typing...', 'typing', 'typing-msg');

            try {
                setTimeout(() => {
                    document.getElementById('typing-msg')?.remove();

                    let response = getResponse(message);

                    addMessage(response, 'assistant');
                    document.getElementById('sendBtn').disabled = false;
                    isTyping = false;
                }, 1500);

            } catch (error) {
                console.error('Erreur:', error);
                document.getElementById('typing-msg')?.remove();
                addMessage("<div class='message-content'>D√©sol√©, une erreur s'est produite. Veuillez r√©essayer.</div>", 'assistant');
                document.getElementById('sendBtn').disabled = false;
                isTyping = false;
            }
        }

        function addMessage(text, type, id = null) {
            const container = document.getElementById('messagesContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            if (id) messageDiv.id = id;

            if (type === 'assistant') {
                messageDiv.innerHTML = text;
            } else {
                const contentDiv = document.createElement('div');
                contentDiv.className = 'message-content';
                contentDiv.textContent = text;
                messageDiv.appendChild(contentDiv);
            }

            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function quickQuestion(question) {
            document.getElementById('userInput').value = question;
            sendMessage();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
    </script>

</body>

</html>